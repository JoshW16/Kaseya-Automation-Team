<?xml version="1.0" encoding="utf-8"?>
<ScExport xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.kaseya.com/vsa/2008/12/Scripting">
  <Procedure name="CopyGatheredFiles" treePres="3" id="1414746033" folderId="639908241545738" treeFullPath="myProcedures - kadmin">
    <Body description="">
      <Statement description="The procedure copies gathered CSV-files to predefined location. It should be executed on the VSA Server&#xD;&#xA;Version: 0.1&#xD;&#xA;Author:  Proserv Team - VS&#xD;&#xA;Path to the UserProfiles folder on the VSA Server" name="GetVariable" continueOnFail="false">
        <Parameter xsi:type="EnumParameter" name="VariableType" value="ConstantValue" />
        <Parameter xsi:type="StringParameter" name="SourceContent" value="C:\Kaseya\UserProfiles" />
        <Parameter xsi:type="StringParameter" name="VariableName" value="VSAPath" />
      </Statement>
      <Statement description="Folders that contain gathered CSV-files" name="GetVariable" continueOnFail="false">
        <Parameter xsi:type="EnumParameter" name="VariableType" value="ConstantValue" />
        <Parameter xsi:type="StringParameter" name="SourceContent" value="'DomainAccountsOnLocalMachine-Information' ,'Encryption-Status' ,'FailedLogin-Information' ,'Local-Users' ,'Lockout-Threshold' ,'Logs-Details' ,'PowerSettings-Information' ,'RDP-Status' ,'ScreenLock-Information' ,'WindowsOSBuild-Information' ,'WindowsPasswordPolicy-Information' ,'WindowsTimeZone-Information' ,'WindowsUpdate-Information'" />
        <Parameter xsi:type="StringParameter" name="VariableName" value="GatherFolders" />
      </Statement>
      <Statement name="ExecuteShellCommand" continueOnFail="false">
        <Parameter xsi:type="StringParameter" name="Command" value="Powershell.exe -NoProfile -ExecutionPolicy Bypass -Command &quot;$ErrorActionPreference = 'SilentlyContinue'; $GatherFolders = @(#GatherFolders#); Get-ChildItem -Path '#VSAPath#' -Force -Recurse -Directory | Where-Object {$_.Name -match '^\d+$'} | Get-ChildItem -Recurse -Force | Where-Object { $_.Name -in $GatherFolders } | ForEach-Object { Copy-Item -Path $_.FullName -Destination $(Join-Path -Path '#VSAPath#' -ChildPath 'PSQueIn') -Container -Force -Recurse}&quot;" />
        <Parameter xsi:type="EnumParameter" name="ExecuteAccount" value="System" />
        <Parameter xsi:type="BooleanParameter" name="Is64Bit" value="False" />
      </Statement>
    </Body>
  </Procedure>
</ScExport>